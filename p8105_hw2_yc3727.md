Homework 2
================
Chloe Chah

``` r
library(tidyverse)
```

    ## ── Attaching packages ───────────────────────────────────── tidyverse 1.3.0 ──

    ## ✓ ggplot2 3.3.2     ✓ purrr   0.3.4
    ## ✓ tibble  3.0.3     ✓ dplyr   1.0.2
    ## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
    ## ✓ readr   1.3.1     ✓ forcats 0.5.0

    ## ── Conflicts ──────────────────────────────────────── tidyverse_conflicts() ──
    ## x dplyr::filter() masks stats::filter()
    ## x dplyr::lag()    masks stats::lag()

``` r
library(readxl)
```

## Problem 1

#### Read the Mr.Trashwheel dataset.

``` r
trashwheel_df = 
  read_xlsx(
    "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
    sheet = "Mr. Trash Wheel",
    range = cell_cols("A:N")) %>% 
  janitor::clean_names() %>%
  drop_na(dumpster) %>%
  mutate(
    sports_balls = round(sports_balls), 
    sports_balls = as.integer(sports_balls)
  )
```

#### Read precipitation data\!

``` r
  precip_2018 = 
   read_excel(
     "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
     sheet = "2018 Precipitation", 
     skip = 1
   ) %>% 
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2018) %>%
  relocate(year)

precip_2017 = 
  read_excel(
     "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx", 
     sheet = "2017 Precipitation", 
     skip = 1
   ) %>% 
  janitor::clean_names() %>%
  drop_na(month) %>%
  mutate(year = 2017) %>%
  relocate(year)
```

#### Now combine annual precipitation.

``` r
  month_df = 
    tibble(
      month = 1:12, 
      month_name = month.name
    )
  
  precip_df = 
    bind_rows(precip_2018, precip_2017)
  
  left_join(precip_df, month_df, by = "month")
```

    ## # A tibble: 24 x 4
    ##     year month total month_name
    ##    <dbl> <dbl> <dbl> <chr>     
    ##  1  2018     1  0.94 January   
    ##  2  2018     2  4.8  February  
    ##  3  2018     3  2.69 March     
    ##  4  2018     4  4.69 April     
    ##  5  2018     5  9.27 May       
    ##  6  2018     6  4.77 June      
    ##  7  2018     7 10.2  July      
    ##  8  2018     8  6.45 August    
    ##  9  2018     9 10.5  September 
    ## 10  2018    10  2.12 October   
    ## # … with 14 more rows

  - This dataset contains information from the Mr. Trashwheel trash
    collector in Baltimore, Maryland. As trash enters the inner harbor,
    the trashwheel collects that trash and stores it in a dumpster.
  - The dataset contains information on year, month, and trash
    collected, including some specific kinds of trash. There are a total
    of 344 rows in our final dataset. Additional data sheets include
    monthly precipitation data.
  - The total precipitation in 2018 is 70.33.
  - The median number of sports balls in 2017 is 8.

## Problem 2

#### Read in csv file, clean variable names, convert entry variable, reformat route columns

``` r
   transit_df = read_csv(
     "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>%
    janitor::clean_names() %>%
    select(line:entry, vending, ada) %>%
    #mutate(entry = ifelse(entry == "YES", "True", "False"))
    mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE)) %>%
    mutate(
      route8 = as.character(route8), 
      route9 = as.character(route9), 
      route10 = as.character(route10), 
      route11 = as.character(route11)) %>%
    pivot_longer(
      route1:route11, 
      names_to = "route_number", 
      values_to = "route_name", 
      names_prefix = "route"
    )
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_double(),
    ##   Route9 = col_double(),
    ##   Route10 = col_double(),
    ##   Route11 = col_double(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

#### Description of the NYC Transit dataset

  - The dataset contains information related to each entrance and exit
    for each subway station in New York City.
  - It contains the following variables: ada, entrance\_type, entry,
    line, route\_name, route\_number, station\_latitude,
    station\_longitude, station\_name, vending.
  - The dataset has 20548 rows and 10 columns.
  - In terms of the data cleaning steps, I first read the csv file into
    R, used the clean\_names() function to clean the variable names.
    Then I used the select function to retain only the desired
    variables. I’ve also converted the entry variable from a character
    variable to a logical variable.
  - This dataset is not yet tidy because there are redundant columns
    that seem to describe the same thing (e.g. route information is
    spread across 11 columns).

#### Next questions about the NYC transit data

``` r
  distinct_transit_df = 
    distinct(transit_df, line, station_name, .keep_all = TRUE) 


#There are a total of `r nrow(distinct_transit_df)` distinct stations. 
#There are a total of `r filter(distinct_transit_df, ada == TRUE) %>% nrow()` stations that are ADA compliant.
#`r filter(transit_df, vending == "NO", entry == "TRUE") %>% nrow()` out of `r filter(transit_df, vending == "NO") %>% nrow()` station entrances/exits without vending allow entrance. 
#There are `r filter(distinct_transit_df, route_name == "A")` distinct stations that serve train A.;
```

## Problem 3

#### Reading in & cleaning data; breaking up mon variable; replacing month number with month name; creating a president variable; deleting prez\_dem, prez\_gop, & day variable;

``` r
pols_df = read_csv(
    "./data/pols-month.csv") %>%
    janitor::clean_names() %>%
    separate(mon, sep = "-", into = c("year", "month", "day")) %>%
    mutate(year = as.integer(year)) %>%
    mutate(month = as.integer(month)) %>%
    mutate(day = as.integer(day))
```

    ## Parsed with column specification:
    ## cols(
    ##   mon = col_date(format = ""),
    ##   prez_gop = col_double(),
    ##   gov_gop = col_double(),
    ##   sen_gop = col_double(),
    ##   rep_gop = col_double(),
    ##   prez_dem = col_double(),
    ##   gov_dem = col_double(),
    ##   sen_dem = col_double(),
    ##   rep_dem = col_double()
    ## )

``` r
month_df = 
    tibble(
        month = 1:12,
        month_name = month.abb)

pols_df =
    left_join(pols_df, month_df, by = "month") %>%
    relocate(month_name, .after = "month") %>%
    mutate(
      president = ifelse(prez_gop == "1", "gop", "dem")) %>%
    relocate(president, .after = "month_name")

pols_df = select(pols_df, -day, -prez_dem, -prez_gop, -month)

pols_df
```

    ## # A tibble: 822 x 9
    ##     year month_name president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem
    ##    <int> <chr>      <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ##  1  1947 Jan        dem            23      51     253      23      45     198
    ##  2  1947 Feb        dem            23      51     253      23      45     198
    ##  3  1947 Mar        dem            23      51     253      23      45     198
    ##  4  1947 Apr        dem            23      51     253      23      45     198
    ##  5  1947 May        dem            23      51     253      23      45     198
    ##  6  1947 Jun        dem            23      51     253      23      45     198
    ##  7  1947 Jul        dem            23      51     253      23      45     198
    ##  8  1947 Aug        dem            23      51     253      23      45     198
    ##  9  1947 Sep        dem            23      51     253      23      45     198
    ## 10  1947 Oct        dem            23      51     253      23      45     198
    ## # … with 812 more rows

#### Cleaning the data in snp.csv using a similar process to the above; Arranging according to year and month; organizing so that year and month are the leading columns.

``` r
snp_df = read_csv(
    "./data/snp.csv") %>%
    janitor::clean_names() %>%
    separate(date, sep = "/", into = c("month", "day", "year")) %>%
    mutate(year = as.integer(year)) %>%
    mutate(month = as.integer(month)) %>%
    mutate(day = as.integer(day)) 
```

    ## Parsed with column specification:
    ## cols(
    ##   date = col_character(),
    ##   close = col_double()
    ## )

``` r
month_df = 
    tibble(
        month = 1:12,
        month_name = month.abb)

snp_df =
    left_join(snp_df, month_df, by = "month") %>%
    subset(select = -c(day,month)) %>%
    relocate(year, month_name)

snp_df
```

    ## # A tibble: 787 x 3
    ##     year month_name close
    ##    <int> <chr>      <dbl>
    ##  1  2015 Jul        2080.
    ##  2  2015 Jun        2063.
    ##  3  2015 May        2107.
    ##  4  2015 Apr        2086.
    ##  5  2015 Mar        2068.
    ##  6  2015 Feb        2104.
    ##  7  2015 Jan        1995.
    ##  8  2014 Dec        2059.
    ##  9  2014 Nov        2068.
    ## 10  2014 Oct        2018.
    ## # … with 777 more rows

#### Tidying the unemployment data so that it can be merged with the previous datasets.

``` r
  unemp_df = read_csv(
    "./data/unemployment.csv") %>%
    janitor::clean_names()
```

    ## Parsed with column specification:
    ## cols(
    ##   Year = col_double(),
    ##   Jan = col_double(),
    ##   Feb = col_double(),
    ##   Mar = col_double(),
    ##   Apr = col_double(),
    ##   May = col_double(),
    ##   Jun = col_double(),
    ##   Jul = col_double(),
    ##   Aug = col_double(),
    ##   Sep = col_double(),
    ##   Oct = col_double(),
    ##   Nov = col_double(),
    ##   Dec = col_double()
    ## )

``` r
  unemp_tidy_df = 
    pivot_longer(
      unemp_df, 
      jan:dec, 
      names_to = "month",
      values_to = "unemployment"
    ) %>%
    mutate(year = as.integer(year))

  unemp_tidy_df
```

    ## # A tibble: 816 x 3
    ##     year month unemployment
    ##    <int> <chr>        <dbl>
    ##  1  1948 jan            3.4
    ##  2  1948 feb            3.8
    ##  3  1948 mar            4  
    ##  4  1948 apr            3.9
    ##  5  1948 may            3.5
    ##  6  1948 jun            3.6
    ##  7  1948 jul            3.6
    ##  8  1948 aug            3.9
    ##  9  1948 sep            3.8
    ## 10  1948 oct            3.7
    ## # … with 806 more rows

#### Join the datasets by merging snp into pols, then merging unemployment into the result.

``` r
  merged_snppols_df = 
    left_join(pols_df, snp_df, by = "year","month")

  merged_all_df = 
    left_join(merged_snppols_df, unemp_tidy_df, by = "year","month")

  merged_all_df
```

    ## # A tibble: 113,124 x 13
    ##     year month_name.x president gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem
    ##    <int> <chr>        <chr>       <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>
    ##  1  1947 Jan          dem            23      51     253      23      45     198
    ##  2  1947 Feb          dem            23      51     253      23      45     198
    ##  3  1947 Mar          dem            23      51     253      23      45     198
    ##  4  1947 Apr          dem            23      51     253      23      45     198
    ##  5  1947 May          dem            23      51     253      23      45     198
    ##  6  1947 Jun          dem            23      51     253      23      45     198
    ##  7  1947 Jul          dem            23      51     253      23      45     198
    ##  8  1947 Aug          dem            23      51     253      23      45     198
    ##  9  1947 Sep          dem            23      51     253      23      45     198
    ## 10  1947 Oct          dem            23      51     253      23      45     198
    ## # … with 113,114 more rows, and 4 more variables: month_name.y <chr>,
    ## #   close <dbl>, month <chr>, unemployment <dbl>

#### Description of the datasets

  - The pols-month dataset contains information related to the number of
    national politicians who are democratic or republican at any given
    time.
  - The snp dataset contains information related to Standard & Poor’s
    stock market index (S\&P) on a given date, often used as a
    representative measure of stock market as a whole.
  - The unemployment dataset contains information related to the
    percentage of unemployment in a given month of a certain year.
  - The final merged dataset contains information from all of the
    aforementioned datsets above merged together by year and date
    through a left join function. The final dataset contains 113124 rows
    and 13 columns.
  - The earliest year recorded in this dataset is 1947 and the most
    recent year recorded in this dataset is 2015: covering a range of 68
    years.
  - It contains the following variables: close, gov\_dem, gov\_gop,
    month, month\_name.x, month\_name.y, president, rep\_dem, rep\_gop,
    sen\_dem, sen\_gop, unemployment, year.
